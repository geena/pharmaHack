<div class="container">
  <h1>New Order</h1>
  <div class="container">
  <script type="text/javascript">

      function ping_test(){
        document.getElementById('order_order_name').innerHTML = "";
        var url = "https://rxnav.nlm.nih.gov/REST/drugs?name=" + $('#order_select').val();
        $.getJSON(url,function(data) { 
          var complete_results = data.drugGroup.conceptGroup[1].conceptProperties;
          var select = document.getElementById('order_order_name');

          complete_results.map(function(result) {
            var opt = document.createElement('option');
            opt.value = JSON.stringify(result);
            opt.innerHTML = result.synonym;
            select.appendChild(opt);
          }); 
        });
      }
  </script>

  <%= form_for :order, url: orders_path do |f| %>

    <p>
      <%= f.label :patient_name %><br>
      <%= f.text_field :patient_name %>
    </p>

    <p>
      <%= f.label :order_name %><br>
      <%= text_field_tag :order_select, '', :onchange => "ping_test()" %>
      <%= f.select :order_name, [] %>
    </p>

    <p>
      <%= f.label :dosage %><br>
      <%= f.text_field :dosage %>
    </p>

    <p>
      <%= f.label :first_dose_priority %><br>
      <%= f.datetime_select :timestamp, :ampm => true %>
    </p>

    <p>
    	<%= f.label :image %><br>
    	<%= f.file_field :image %>
    </p>

    <%= f.hidden_field :status, value: 'active' %>

    <p>
      <%= f.submit %>
    </p>
  <% end %>
</div>
  <h1> <%= link_to 'Back', controller: 'physician' %> </h1>
</div>